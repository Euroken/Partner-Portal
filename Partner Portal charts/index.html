<style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      background-color: #f8f9fa;
      padding: 20px;
    }
    
    .dashboard {
      background: white;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      width: 80%;
    }
    
    .target-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .target-label {
      font-size: 16px;
      color: #2196F3;
      font-weight: 500;
      margin-bottom: 8px;
    }
    
    .target-amount {
      font-size: 48px;
      font-weight: 700;
      color: #2196F3;
      margin: 0;
    }
    
    .discount-cards {
      display: flex;
      gap: 20px;
      margin-bottom: 40px;
      justify-content: center;
    }
    
    .discount-card {
      background: #f5f5f5;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      flex: 1;
      max-width: 200px;
    }
    
    .discount-label {
      font-size: 14px;
      color: #2196F3;
      font-weight: 500;
      margin-bottom: 8px;
    }
    
    .discount-value {
      font-size: 32px;
      font-weight: 700;
      color: #2196F3;
      margin: 0;
    }
    
  .charts-container {
    display: flex;
    gap: 40px;
    align-items: flex-start; /* Ensures titles align horizontally */
    justify-content: center;
  }
    
    .main-chart-container {
      position: relative;
      flex: 2;
    }
    
    .chart-title {
      text-align: center;
      font-size: 16px;
      color: black;
      font-weight: 500;
      margin-bottom: 20px;
    }
    
    .chart-wrapper {
      position: relative;
      width: 400px;
      height: 250px;
      margin: 0 auto;
    }
    
    .center-amount {
      position: absolute;
      bottom: 5%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      font-size: 24px;
      font-weight: 700;
      color: #2196F3;
      z-index: 10;
    }
    
    /* Account Manager Contribution Styles */
    .account-manager-header {
      margin-bottom: 60px;
    }
    
    .account-manager-header h2 {
      margin: 0;
      font-size: 18px;
      font-weight: 600;
      color: #333;
    }
    
    .account-manager-container {
      display: flex;
      align-items: center;
      gap: 40px;
    }
    
    .account-manager-chart {
      position: relative;
      width: 300px;
      height: 200px;
      flex: 2;
    }
    
    .account-manager-center {
      position: absolute;
      top: 75%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 36px;
      font-weight: 700;
      color: #2196F3;
      z-index: 10;
    }
    
    .account-manager-legend {
      flex: 1;
    }
    
    .legend-title {
      font-size: 14px;
      font-weight: 600;
      color: #333;
      margin-bottom: 15px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
      font-size: 14px;
    }
    
    .legend-item input[type="checkbox"] {
      width: 16px;
      height: 16px;
    }
    
    .legend-color {
      width: 16px;
      height: 16px;
      border-radius: 2px;
    }
    
    .themba-color {
      background-color: #2196F3;
    }
    
    .unknown-color {
      background-color: #666666;
    }
    
    .legend-item label {
      cursor: pointer;
      color: #333;
    }

    .history-header {
      margin-bottom: 60px;
    }
    
    .history-header h2 {
      margin: 0;
      font-size: 18px;
      font-weight: 600;
      color: #333;
    }
    .header-navbar {
      width: 80%;
      padding: 10px 20px;
      box-sizing: border-box;
      display: flex;
      justify-content: flex-start; /* Aligns content to the left */
      align-items: center;
      margin-bottom: 20px; /* Adds some space below the header */
    }

    .navbar-logo {
      height: 50px; /* Adjust the height as needed */
      
    }
  </style>
  <div class="dashboard">
    <div class="target-header">
      <div class="target-label">Target for the Year</div>
      <div class="target-amount">R 2,000,000.00</div>
    </div>
    
    <div class="discount-cards">
      <div class="discount-card">
        <div class="discount-label">Net New Logo Discount</div>
        <div class="discount-value">12.50%</div>
      </div>
      <div class="discount-card">
        <div class="discount-label">New Business Discount</div>
        <div class="discount-value">10.00%</div>
      </div>
      <div class="discount-card">
        <div class="discount-label">Renewal Discount</div>
        <div class="discount-value">5.00%</div>
      </div>
    </div>
    
    <div class="charts-container">
      <div class="main-chart-container">
        <div class="chart-title">New Business Achieved</div>
        <div class="chart-wrapper">
          <canvas id="mainChart"></canvas>
          <div class="center-amount">R 3,073,053.97</div>
        </div>
      </div>

    </div>
  </div>
  
  <div class="dashboard" style="margin-top: 30px;">
    <div class="account-manager-header">
      <h2>Account Manager Contribution</h2>
    </div>
    
    <div class="account-manager-container">
      <div class="account-manager-chart">
        <canvas id="accountManagerChart"></canvas>
        <div class="account-manager-center">R 3.54M</div>
      </div>
      
      <div class="account-manager-legend">
        <div class="legend-title">Account Manager Name</div>
        <div class="legend-item">
          <input type="checkbox" id="themba" checked>
          <span class="legend-color themba-color"></span>
          <label for="themba">Themba Nkosi</label>
        </div>
        <div class="legend-item">
          <input type="checkbox" id="unknown" checked>
          <span class="legend-color unknown-color"></span>
          <label for="unknown">Unknown</label>
        </div>
      </div>
    </div>
  </div>

  <div class="dashboard" style="margin-top: 30px;">
    <div class="history-header">
      <h2>History (New Business)</h2>
    </div>
    
    <div class="history-container">
        <div class="history-chart">
          <canvas id="historyChart"></canvas>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@3"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <script>
    const speed = 75;
    let animationAngle = 0;
    const pointer = {
      id: 'pointer',
      defaults:{
      percentage: 0,
      maxAngle: 0
      },
      afterDraw: function(chart, args, opt) {
        const { ctx } = chart;
        var data = chart._metasets[0].data[0];
        var radius = data.outerRadius;
        var centerX = data.x;
        var centerY = data.y;
        const angle = (Math.PI * ( speed / 100) * chart.options.plugins.pointer.percentage)  +  Math.PI;
        var x = centerX + radius * Math.cos( angle );
        var y = centerY + radius * Math.sin( angle );
        ctx.save();
        ctx.beginPath();
        ctx.lineWidth = 4;
        ctx.strokeStyle = 'white';
        ctx.moveTo(centerX, centerY);
        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.restore();
      },
    }
    const targetAmount = 2000000.00;
    const achievedAmount = 3073053.97;
    const percentageAchieved = (achievedAmount / targetAmount * 100).toFixed(1);
    
    // Main semi-doughnut chart
    const ctx1 = document.getElementById('mainChart').getContext('2d');
    const gradient1 = ctx1.createLinearGradient(0, 0, 400, 250);
    gradient1.addColorStop(0, '#1563FF');    
    gradient1.addColorStop(1, '#012B90'); 
        
    // For the main chart, we show the full achievement even if it exceeds target
    const mainChart = new Chart(ctx1, {
      type: 'doughnut',
      data: {
        labels: ['Achieved', 'Remaining'],
        datasets: [{
          data: [achievedAmount, Math.max(0, targetAmount - achievedAmount)],
          backgroundColor: [gradient1, '#e0e0e0'],
          borderWidth: 0,
          cutout: '70%'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        circumference: 180,
        rotation: -90,
        animation:{
          onProgress: function(context){
              if(context.initial){
                  this.options.plugins.pointer.percentage = context.currentStep / context.numSteps;
              }
          }
        },
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            enabled: true,
            displayColors: false,
            callbacks: {
              title: () => '', // Removes the default title
              label: (context) => {
                const label = context.label;
                if (label === 'Achieved') {
                  return [
                    `Target: R ${targetAmount.toLocaleString('en-ZA')}`,
                    `Achieved: R ${achievedAmount.toLocaleString('en-ZA')} (${percentageAchieved}%)`
                  ];
                }
                return `Remaining: R ${context.raw.toLocaleString('en-ZA')}`;
              }
            }
          },
          pointer: {currentAngle: 1}
        }
      },
      plugins:[pointer]
    });
    
    // Account Manager Contribution Chart
    const ctx3 = document.getElementById('accountManagerChart').getContext('2d');
    const gradient3 = ctx3.createLinearGradient(0, 0, 400, 300);
    gradient3.addColorStop(0, '#1563FF');    
    gradient3.addColorStop(1, '#012B90');
    
    // Data for account manager contribution
    const thembaAmount = 2193489.11; // 54.20% of 3.07M
    const unknownAmount = 1345949.36; // 45.80% of 3.07M
    const totalAmount = thembaAmount + unknownAmount;
    
    const accountManagerChart = new Chart(ctx3, {
      type: 'doughnut',
      data: {
        labels: ['Themba Nkosi', 'Unknown'],
        datasets: [{
          data: [thembaAmount, unknownAmount],
          backgroundColor: [gradient3, '#b0b0b0'],
          borderWidth: 0,
          cutout: '60%'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        circumference: 180,
        rotation: -90,
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            enabled: true,
            callbacks: {
              label: function(context) {
                const label = context.label || '';
                const value = context.raw;
                return `${label}: R ${value.toLocaleString('en-ZA')}`;
              }
            }
          },
          datalabels: {
            color: '#fff',
            font: {
              weight: 'bold',
              size: 14
            },
            formatter: (value, context) => {
              const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
              if (value === 0) return ''; // Skip label if hidden
              const percentage = (value / total * 100).toFixed(2);
              return percentage + '%';
            }
          }
        },
      },
      plugins: [ChartDataLabels]
    });
    // History Chart
    const ctx4 = document.getElementById('historyChart').getContext('2d');
    const historyChart = new Chart(ctx4, {
      type: "bar",
      options: {
        plugins: {
          legend: {
            display: false,
          },
          datalabels: {
            color: '#fff',
            font: {
              weight: 'bold',
              size: 14
            },
            formatter: (value) => {
              return `R${value.toLocaleString('en-ZA')}`; // Adds comma/thousand separators
            }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const value = context.raw;
                return `R ${value.toLocaleString('en-ZA')}`;
              }
            }
          }
        }
      },
      data: {
        labels: ["2022", "2023", "2024", "2025"],
        datasets: [{
          label: false,
          data: [44951.50, 408137.23, 1363455.09, 3539438.47],
          backgroundColor: [
            'rgba(21, 99, 255)',
            'rgb(31, 34, 196)',
            'rgb(0, 46, 196)',
            'rgba(1, 43, 144)'
          ],
        }]
      },
      plugins: [ChartDataLabels]
    });
    // Handle legend checkboxes
    document.getElementById('themba').addEventListener('change', function() {
      const dataset = accountManagerChart.data.datasets[0];
      if (this.checked) {
        dataset.data[0] = thembaAmount;
      } else {
        dataset.data[0] = 0;
      }
      accountManagerChart.update();
    });
    
    document.getElementById('unknown').addEventListener('change', function() {
      const dataset = accountManagerChart.data.datasets[0];
      if (this.checked) {
        dataset.data[1] = unknownAmount;
      } else {
        dataset.data[1] = 0;
      }
      accountManagerChart.update();
    });
  </script>